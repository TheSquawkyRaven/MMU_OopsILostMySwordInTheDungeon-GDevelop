{
  "associatedLayout": "Game Scene",
  "lastChangeTimeStamp": 0,
  "name": "Running Behaviours",
  "events": [
    {
      "type": "BuiltinCommonInstructions::Link",
      "include": {
        "includeConfig": 0
      },
      "target": "Post Turn Event"
    },
    {
      "type": "BuiltinCommonInstructions::Standard",
      "conditions": [],
      "actions": []
    },
    {
      "type": "BuiltinCommonInstructions::Comment",
      "color": {
        "b": 109,
        "g": 230,
        "r": 255,
        "textB": 0,
        "textG": 0,
        "textR": 0
      },
      "comment": "Flip enemies which have detected enemies",
      "comment2": ""
    },
    {
      "type": "BuiltinCommonInstructions::ForEach",
      "object": "Enemies",
      "conditions": [
        {
          "type": {
            "value": "VarObjet"
          },
          "parameters": [
            "Enemies",
            "State",
            ">=",
            "1"
          ]
        },
        {
          "type": {
            "value": "NbObjet"
          },
          "parameters": [
            "Player",
            ">",
            "0"
          ]
        }
      ],
      "actions": [],
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "PosX"
              },
              "parameters": [
                "Enemies",
                "<",
                "Player.X()"
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "FlipX"
              },
              "parameters": [
                "Enemies",
                "no"
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "PosX"
              },
              "parameters": [
                "Enemies",
                ">",
                "Player.X()"
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "FlipX"
              },
              "parameters": [
                "Enemies",
                "yes"
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "BuiltinCommonInstructions::Comment",
      "color": {
        "b": 109,
        "g": 230,
        "r": 255,
        "textB": 0,
        "textG": 0,
        "textR": 0
      },
      "comment": "Pathfinder Get Direction of Movement",
      "comment2": ""
    },
    {
      "type": "BuiltinCommonInstructions::ForEach",
      "object": "Pathfinder",
      "conditions": [
        {
          "type": {
            "value": "ObjectVariableAsBoolean"
          },
          "parameters": [
            "Pathfinder",
            "Moved",
            "False"
          ]
        },
        {
          "type": {
            "value": "BuiltinCommonInstructions::Or"
          },
          "parameters": [],
          "subInstructions": [
            {
              "type": {
                "value": "VarObjet"
              },
              "parameters": [
                "Pathfinder",
                "LastPos.x",
                "!=",
                "Pathfinder.X()"
              ]
            },
            {
              "type": {
                "value": "VarObjet"
              },
              "parameters": [
                "Pathfinder",
                "LastPos.y",
                "!=",
                "Pathfinder.Y()"
              ]
            }
          ]
        }
      ],
      "actions": [],
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "VarObjet"
              },
              "parameters": [
                "Pathfinder",
                "LastPos.x",
                "<",
                "Pathfinder.X()"
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "ModVarObjet"
              },
              "parameters": [
                "Pathfinder",
                "Movement.x",
                "=",
                "1"
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "VarObjet"
              },
              "parameters": [
                "Pathfinder",
                "LastPos.x",
                ">",
                "Pathfinder.X()"
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "ModVarObjet"
              },
              "parameters": [
                "Pathfinder",
                "Movement.x",
                "=",
                "-1"
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "VarObjet"
              },
              "parameters": [
                "Pathfinder",
                "LastPos.y",
                "<",
                "Pathfinder.Y()"
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "ModVarObjet"
              },
              "parameters": [
                "Pathfinder",
                "Movement.y",
                "=",
                "1"
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "VarObjet"
              },
              "parameters": [
                "Pathfinder",
                "LastPos.y",
                ">",
                "Pathfinder.Y()"
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "ModVarObjet"
              },
              "parameters": [
                "Pathfinder",
                "Movement.y",
                "=",
                "-1"
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "BuiltinCommonInstructions::Or"
              },
              "parameters": [],
              "subInstructions": [
                {
                  "type": {
                    "value": "VarObjet"
                  },
                  "parameters": [
                    "Pathfinder",
                    "Movement.x",
                    "!=",
                    "0"
                  ]
                },
                {
                  "type": {
                    "value": "VarObjet"
                  },
                  "parameters": [
                    "Pathfinder",
                    "Movement.y",
                    "!=",
                    "0"
                  ]
                }
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "SetObjectVariableAsBoolean"
              },
              "parameters": [
                "Pathfinder",
                "Moved",
                "True"
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "ObjectVariableAsBoolean"
              },
              "parameters": [
                "Pathfinder",
                "Moved",
                "True"
              ]
            }
          ],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "LinkedObjects::PickObjectsLinkedTo"
                  },
                  "parameters": [
                    "",
                    "Enemies",
                    "Pathfinder",
                    ""
                  ]
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "ModVarObjet"
                  },
                  "parameters": [
                    "Enemies",
                    "Movement.x",
                    "=",
                    "Pathfinder.Variable(Movement.x)"
                  ]
                },
                {
                  "type": {
                    "value": "ModVarObjet"
                  },
                  "parameters": [
                    "Enemies",
                    "Movement.y",
                    "=",
                    "Pathfinder.Variable(Movement.y)"
                  ]
                }
              ],
              "events": [
                {
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "LinkedObjects::PickObjectsLinkedTo"
                      },
                      "parameters": [
                        "",
                        "MoveDirectionMarker",
                        "Enemies",
                        ""
                      ]
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "SetAngle"
                      },
                      "parameters": [
                        "MoveDirectionMarker",
                        "=",
                        "AngleBetweenPositions(0, 0, Enemies.Variable(Movement.x), Enemies.Variable(Movement.y)) + 90"
                      ]
                    },
                    {
                      "type": {
                        "value": "Montre"
                      },
                      "parameters": [
                        "MoveDirectionMarker",
                        ""
                      ]
                    },
                    {
                      "type": {
                        "value": "SetSceneVariableAsBoolean"
                      },
                      "parameters": [
                        "ifelse",
                        "False"
                      ]
                    }
                  ],
                  "events": [
                    {
                      "type": "BuiltinCommonInstructions::Standard",
                      "conditions": [
                        {
                          "type": {
                            "value": "BuiltinCommonInstructions::Or"
                          },
                          "parameters": [],
                          "subInstructions": [
                            {
                              "type": {
                                "value": "VarObjet"
                              },
                              "parameters": [
                                "Enemies",
                                "Movement.x",
                                "<",
                                "0"
                              ]
                            },
                            {
                              "type": {
                                "value": "VarObjet"
                              },
                              "parameters": [
                                "Enemies",
                                "Movement.y",
                                "<",
                                "0"
                              ]
                            }
                          ]
                        }
                      ],
                      "actions": [
                        {
                          "type": {
                            "value": "SetSceneVariableAsBoolean"
                          },
                          "parameters": [
                            "ifelse",
                            "True"
                          ]
                        },
                        {
                          "type": {
                            "value": "MettreXY"
                          },
                          "parameters": [
                            "MoveDirectionMarker",
                            "=",
                            "Enemies.Variable(Pos.x) * Variable(tileSize) + (abs(Enemies.Variable(Movement.y)) * (Variable(tileSize) / 2))",
                            "=",
                            "Enemies.Variable(Pos.y) * Variable(tileSize) + (abs(Enemies.Variable(Movement.x)) * (Variable(tileSize) / 2))"
                          ]
                        }
                      ]
                    },
                    {
                      "type": "BuiltinCommonInstructions::Standard",
                      "conditions": [
                        {
                          "type": {
                            "value": "SceneVariableAsBoolean"
                          },
                          "parameters": [
                            "ifelse",
                            ""
                          ]
                        }
                      ],
                      "actions": [
                        {
                          "type": {
                            "value": "SetSceneVariableAsBoolean"
                          },
                          "parameters": [
                            "ifelse",
                            "True"
                          ]
                        },
                        {
                          "type": {
                            "value": "MettreXY"
                          },
                          "parameters": [
                            "MoveDirectionMarker",
                            "=",
                            "Enemies.Variable(Pos.x) * Variable(tileSize) + Enemies.Variable(Movement.x) * Variable(tileSize) + (abs(Enemies.Variable(Movement.y)) * (Variable(tileSize) / 2))",
                            "=",
                            "Enemies.Variable(Pos.y) * Variable(tileSize) + Enemies.Variable(Movement.y) * Variable(tileSize) + (abs(Enemies.Variable(Movement.x)) * (Variable(tileSize) / 2))"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "disabled": true,
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "LinkedObjects::PickObjectsLinkedTo"
                      },
                      "parameters": [
                        "",
                        "AttackDirectionMarker",
                        "Enemies",
                        ""
                      ]
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "Cache"
                      },
                      "parameters": [
                        "AttackDirectionMarker"
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "BuiltinCommonInstructions::Comment",
      "color": {
        "b": 109,
        "g": 230,
        "r": 255,
        "textB": 0,
        "textG": 0,
        "textR": 0
      },
      "comment": "Projectile Hit",
      "comment2": ""
    },
    {
      "type": "BuiltinCommonInstructions::Standard",
      "conditions": [],
      "actions": [],
      "events": [
        {
          "type": "BuiltinCommonInstructions::ForEach",
          "object": "Projectile",
          "conditions": [],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::ForEach",
              "object": "Enemies",
              "conditions": [
                {
                  "type": {
                    "value": "ObjectVariableAsBoolean"
                  },
                  "parameters": [
                    "Enemies",
                    "ProjectileCaptured",
                    ""
                  ]
                }
              ],
              "actions": [],
              "events": [
                {
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "CollisionNP"
                      },
                      "parameters": [
                        "Enemies",
                        "Projectile",
                        "",
                        "",
                        "yes"
                      ]
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "SetObjectVariableAsBoolean"
                      },
                      "parameters": [
                        "Enemies",
                        "ProjectileCaptured",
                        "True"
                      ]
                    },
                    {
                      "type": {
                        "value": "SetObjectVariableAsBoolean"
                      },
                      "parameters": [
                        "Enemies",
                        "CannotMove",
                        "True"
                      ]
                    },
                    {
                      "type": {
                        "value": "SetObjectVariableAsBoolean"
                      },
                      "parameters": [
                        "Projectile",
                        "HitEnemy",
                        "True"
                      ]
                    },
                    {
                      "type": {
                        "value": "LinkedObjects::LinkObjects"
                      },
                      "parameters": [
                        "",
                        "Enemies",
                        "Projectile"
                      ]
                    }
                  ],
                  "events": [
                    {
                      "type": "BuiltinCommonInstructions::Standard",
                      "conditions": [],
                      "actions": [
                        {
                          "type": {
                            "value": "ModVarObjet"
                          },
                          "parameters": [
                            "Enemies",
                            "Movement.x",
                            "=",
                            "0"
                          ]
                        },
                        {
                          "type": {
                            "value": "ModVarObjet"
                          },
                          "parameters": [
                            "Enemies",
                            "Movement.y",
                            "=",
                            "0"
                          ]
                        }
                      ],
                      "events": [
                        {
                          "type": "BuiltinCommonInstructions::Standard",
                          "conditions": [
                            {
                              "type": {
                                "value": "LinkedObjects::PickObjectsLinkedTo"
                              },
                              "parameters": [
                                "",
                                "MoveDirectionMarker",
                                "Enemies",
                                ""
                              ]
                            }
                          ],
                          "actions": [
                            {
                              "type": {
                                "value": "Cache"
                              },
                              "parameters": [
                                "MoveDirectionMarker"
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::ForEach",
          "object": "Projectile",
          "conditions": [
            {
              "type": {
                "value": "ObjectVariableAsBoolean"
              },
              "parameters": [
                "Projectile",
                "HitEnemy",
                "True"
              ]
            }
          ],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "LinkedObjects::PickObjectsLinkedTo"
                  },
                  "parameters": [
                    "",
                    "Enemies",
                    "Projectile",
                    ""
                  ]
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "MettreXY"
                  },
                  "parameters": [
                    "Enemies",
                    "=",
                    "Projectile.X()",
                    "=",
                    "Projectile.Y()"
                  ]
                },
                {
                  "type": {
                    "value": "ModVarScene"
                  },
                  "parameters": [
                    "Map[Enemies.Variable(Pos.x)][Enemies.Variable(Pos.y)].c",
                    "=",
                    "0"
                  ]
                },
                {
                  "type": {
                    "value": "ModVarObjet"
                  },
                  "parameters": [
                    "Enemies",
                    "Pos.x",
                    "=",
                    "abs(Enemies.X() / Variable(tileSize))"
                  ]
                },
                {
                  "type": {
                    "value": "ModVarObjet"
                  },
                  "parameters": [
                    "Enemies",
                    "Pos.y",
                    "=",
                    "abs(Enemies.Y() / Variable(tileSize))"
                  ]
                },
                {
                  "type": {
                    "value": "ModVarScene"
                  },
                  "parameters": [
                    "Map[Enemies.Variable(Pos.x)][Enemies.Variable(Pos.y)].c",
                    "=",
                    "1"
                  ]
                }
              ],
              "events": [
                {
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "LinkedObjects::PickObjectsLinkedTo"
                      },
                      "parameters": [
                        "",
                        "AttackDirectionMarker",
                        "Enemies",
                        ""
                      ]
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "SetSceneVariableAsBoolean"
                      },
                      "parameters": [
                        "ifelse2",
                        "False"
                      ]
                    }
                  ],
                  "events": [
                    {
                      "type": "BuiltinCommonInstructions::Standard",
                      "conditions": [
                        {
                          "type": {
                            "value": "BuiltinCommonInstructions::Or"
                          },
                          "parameters": [],
                          "subInstructions": [
                            {
                              "type": {
                                "value": "VarObjet"
                              },
                              "parameters": [
                                "Enemies",
                                "Attack.x",
                                "<",
                                "0"
                              ]
                            },
                            {
                              "type": {
                                "value": "VarObjet"
                              },
                              "parameters": [
                                "Enemies",
                                "Attack.y",
                                "<",
                                "0"
                              ]
                            }
                          ]
                        }
                      ],
                      "actions": [
                        {
                          "type": {
                            "value": "SetSceneVariableAsBoolean"
                          },
                          "parameters": [
                            "ifelse2",
                            "True"
                          ]
                        },
                        {
                          "type": {
                            "value": "MettreXY"
                          },
                          "parameters": [
                            "AttackDirectionMarker",
                            "=",
                            "Enemies.Variable(Pos.x) * Variable(tileSize) + (abs(Enemies.Variable(Attack.y)) * (Variable(tileSize) / 2))",
                            "=",
                            "Enemies.Variable(Pos.y) * Variable(tileSize) + (abs(Enemies.Variable(Attack.x)) * (Variable(tileSize) / 2))"
                          ]
                        }
                      ]
                    },
                    {
                      "type": "BuiltinCommonInstructions::Standard",
                      "conditions": [
                        {
                          "type": {
                            "value": "SceneVariableAsBoolean"
                          },
                          "parameters": [
                            "ifelse2",
                            ""
                          ]
                        }
                      ],
                      "actions": [
                        {
                          "type": {
                            "value": "SetSceneVariableAsBoolean"
                          },
                          "parameters": [
                            "ifelse2",
                            "True"
                          ]
                        },
                        {
                          "type": {
                            "value": "MettreXY"
                          },
                          "parameters": [
                            "AttackDirectionMarker",
                            "=",
                            "Enemies.Variable(Pos.x) * Variable(tileSize) + Enemies.Variable(Attack.x) * Variable(tileSize) + (abs(Enemies.Variable(Attack.y)) * (Variable(tileSize) / 2))",
                            "=",
                            "Enemies.Variable(Pos.y) * Variable(tileSize) + Enemies.Variable(Attack.y) * Variable(tileSize) + (abs(Enemies.Variable(Attack.x)) * (Variable(tileSize) / 2))"
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "LinkedObjects::PickObjectsLinkedTo"
                      },
                      "parameters": [
                        "",
                        "AttackingMarker",
                        "Enemies",
                        ""
                      ]
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "MettreXY"
                      },
                      "parameters": [
                        "AttackingMarker",
                        "=",
                        "Enemies.Variable(Pos.x) * Variable(tileSize)",
                        "=",
                        "Enemies.Variable(Pos.y) * Variable(tileSize) + 4"
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "BuiltinCommonInstructions::Comment",
      "color": {
        "b": 109,
        "g": 230,
        "r": 255,
        "textB": 0,
        "textG": 0,
        "textR": 0
      },
      "comment": "Detection Lines",
      "comment2": ""
    },
    {
      "type": "BuiltinCommonInstructions::Standard",
      "conditions": [],
      "actions": [],
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": [
            {
              "type": {
                "value": "ModVarScene"
              },
              "parameters": [
                "i",
                "=",
                "1"
              ]
            }
          ]
        },
        {
          "infiniteLoopWarning": true,
          "type": "BuiltinCommonInstructions::While",
          "whileConditions": [
            {
              "type": {
                "value": "VarScene"
              },
              "parameters": [
                "i",
                "<=",
                "Variable(LineIndex)"
              ]
            }
          ],
          "conditions": [],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "ObjectVariableAsBoolean"
                  },
                  "parameters": [
                    "TrapDetectionLines",
                    "Lines[Variable(i)].Enable",
                    "True"
                  ]
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "PrimitiveDrawing::LineV2"
                  },
                  "parameters": [
                    "TrapDetectionLines",
                    "TrapDetectionLines.Variable(Lines[Variable(i)].x1)",
                    "TrapDetectionLines.Variable(Lines[Variable(i)].y1)",
                    "TrapDetectionLines.Variable(Lines[Variable(i)].x2)",
                    "TrapDetectionLines.Variable(Lines[Variable(i)].y2)",
                    "TrapDetectionLines.Variable(Lines[Variable(i)].Thickness)"
                  ]
                }
              ]
            },
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [],
              "actions": [
                {
                  "type": {
                    "value": "ModVarScene"
                  },
                  "parameters": [
                    "i",
                    "+",
                    "1"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "BuiltinCommonInstructions::Comment",
      "color": {
        "b": 109,
        "g": 230,
        "r": 255,
        "textB": 0,
        "textG": 0,
        "textR": 0
      },
      "comment": "Projectile Disappear",
      "comment2": ""
    },
    {
      "type": "BuiltinCommonInstructions::Standard",
      "conditions": [],
      "actions": [],
      "events": [
        {
          "type": "BuiltinCommonInstructions::ForEach",
          "object": "Projectile",
          "conditions": [
            {
              "type": {
                "value": "ObjectVariableAsBoolean"
              },
              "parameters": [
                "Projectile",
                "Stopped",
                "True"
              ]
            },
            {
              "type": {
                "value": "ObjectVariableAsBoolean"
              },
              "parameters": [
                "Projectile",
                "HitEnemy",
                "False"
              ]
            }
          ],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [],
              "actions": [
                {
                  "type": {
                    "value": "SetAngle"
                  },
                  "parameters": [
                    "Projectile",
                    "+",
                    "10"
                  ]
                },
                {
                  "type": {
                    "value": "ChangeScale"
                  },
                  "parameters": [
                    "Projectile",
                    "-",
                    "0.005"
                  ]
                }
              ]
            },
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "ScaleWidth"
                  },
                  "parameters": [
                    "Projectile",
                    "<=",
                    "0"
                  ]
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "Delete"
                  },
                  "parameters": [
                    "Projectile",
                    ""
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}